11. 논리적 망분리 시 인터넷망 가상화, 업무망 가상화의 장점을 각각 2가지 이상 서술하시오.
 - 인터넷망 가상화
  1) 가상화된 인터넷 환경 제공으로 인한 악성코드 감염을 최소화
  2) 인터넷 환경이 악성코드에 감염되거나 해킹을 당해도 업무 환경은 안전하게 유지 가능
 - 업무망 가상화
  1) 가상화 서버 환경에 업무정보가 저장됨에 따라 업무 데이터 중앙 관리 및 백업이 용이하고 내부정보 유출 방지효과
  2) 사용자 통제 및 관리 정책의 일괄 적용 가능
 
12. 사이트 보안 담당자는 신규 도입된 보안장비(방화벽, IPS/IDS, VPN 등)에 대해 취약점 분석 평가를 실시하고자 한다. 보안장비의 계정관리 취약점 측면에서 조치해야할 사항을 4가지 이상 서술하시오.
 - 관리자 계정 : 보안장비에 기본적으로 설정되어 있는 관리자 계정을 변경한다.
 - 관리자 계정의 패스워드 : 보안장비에 기본적으로 설정되어 있는 관리자 계정의 패스워드를 변경한다.
 - 계정별 권한 설정 : 보안장비에 등록된 계정별 권한을 설정한다.
 - 계정 관리 : 보안장비에 등록되어 있는 계정 중 사용하지 않는 계정을 제거 또는 관리한다.
 
13. 다음은 HTTP GET Flooding 공격에 대한 스노트 탐지이다. 다음 각각의 질문에 답하시오.
alert tcp any any -> any 80 (msg:"HTTP Get Flooding Detect"; content:"GET / HTTP1."; (); nocase; threshold:type threshold, track by_src, count 10, seconds 1; sid:1000999)
(1) 스노트 룰의 action은 패킷이 탐지되었을 때의 처리방식을 의미한다. 탐지된 패킷을 차단하고 로그를 남기는 action 유형 2가지를 쓰시오
(2) 스노트 룰의 content 옵션은 패킷의 페이로드에서 검사할 문자열을 지정하기 위한 옵션이다. [보기]의 룰에서 content 옵션으로 지정한 문자열을 페이로드의 첫 번째 바이트로부터 13번째 바이트 범위 내에서 검사하고자 할 때 빈 칸에 들어갈 옵션을 문법에 맞게 정확히 기술하시오.
(3) 스노트 룰의 threshold 옵션은 특정 시간동안 발생하는 이벤트 수를 제한하여 과도하게 많은 이벤트가 발생하는 것을 방지하기 위한 옵션이다. [보기]의 룰에서 alert 이벤트 발생 수를 제한하는 기준과 방식을 정확히 기술하시오
 - (1) : drop, reject
 - (2) : depth 13
 - (3) : 출발지를 기준으로 매 1초동안 10번째 이벤트마다 alert action을 수행
 
14. 리눅스에서 (1)최근 사용한 명령어를 확인하기 위한 명령어, (2)파일 속성 확인을 위한 명령어, (3)root 권한으로 삭제되지 않는 파일의 속성을 변경하기 위한 명령어를 쓰시오
 - (1) : last
 - (2) : lsattr
 - (3) : chattr -i 파일명 (+부가 -삭제)
 15. 최근 알려진 NTP 취약점을 이용한 분산 서비스 거부 공격은 공격 대상 IP로 출발지 IP를 변경한 monlist 요청을 다수의 NTP 서버로 전달하여 대량의 monlist 응답 패킷이 공격 대상으로 향하도록 하는 공격이다. 다음과 같은 보안 권고안에 대하여 그 의미를 설명하시오.
[NTP 취약점 대응방안]
(1) ntp -version
(2) disable monlist
(3) ntpdc -c monlist "점검 대상 NTP 서버 IP"
(4) iptables -A OUT -p udp --sport 123 -m length --length 100 -j DROP
 - (1) NTP 데몬의 버전을 확인하여 monlist 기능이 해제된 최신 버전으로 업그레이드 한다.
 - (2) NTP 데몬의 monlist 기능을 해제한다.
 - (3) 점검 대상 NTP 서버가 monlist 명령을 허용하는 지 여부를 점검한다.
 - (4) NTP 서버의 iptables를 이용하여 100byte 이상의 NTP 응답을 차단한다.
 
16. 정보통신서비스를 제공하는 사이트의 개인정보 관리 실태를 점검한 결과 개인정보파일에 다음 항목이 모두 암호화되지 않은 것을 확인하였다. 이 중 최소한 암호화가 필요한 항목 (A)와 대상별 안정성 기준 및 암호 알고리즘 (B)에 대해 서술하시오.
1. 이름, 2. 성별, 3. 전화번호, 4. 비밀번호, 5. 주민등록번호, 6. 여권번호, 7. 신용카드번호
 - (A) : 비밀번호, 주민등록번호, 여권번호, 신용카드번호
 - (B) : 비밀번호는 복호화되지 않도록 안전한 일방향 알고리즘 SHA-224/256/384/512 등이 있으며 암호화한 해시 값이 쉽게 크래킹되지 않도록 암호화 시 솔트(salt), 반복횟수 등을 추가하여 암호 강도를 높인다. 주민등록번호, 여권번호, 신용카드번호는 안전한 암호화 알고리즘을 사용하여 암호화한다. SEED, ARIA-128/192/256, AES-128/192/256 등이 있으며 공개키 암호화 알고리즘에는 키 길이 2048bit 이상의 RSA 등이 있다.

11. 파일 업로드 취약점 대응을 위한 .htaccess 파일 설정의 의미에 대하여 답하시오
(1)<FilesMatch \.(ph|lib|sh|)
Order Allow DENY
Deny From ALL
</FilesMatch>
(2)AddType text/html .php .php1.php2.php3 .php4 .phtml
 - (1) FilesMatch 지시자를 이용, .ph, .lib, .sh 등의 Server Side Script 파일에 대해서 직접 URL 호출 금지(업로드된 스크립트(웹쉘)의 실행을 방지하기 위한 목적)
 - (2) AddType 지시자를 이용 Server Side Script 확장자를 text/html MIME Type으로 재조정하여 업로드된 스크립트 실행 방지
 
12. IDS는 내부 트래픽에 대하여 미러 방식으로 사용하고, IPS는 인라인 방식으로 외부와 내부 접점에 배치하여 사용하는 이유는?
 - IPS는 실시간 차단을 목적으로 하기 때문에 인라인 방식으로 구성되어야 하며, 외부에서의 악의적인 침입 시도를 차단하는데 포커스를 두어 내부와 외부의 접점에 배치하는 것이 좋다. IPS를 내부망에 배치하여 운영하는 경우 오탐으로 인하여 네트워크에 문제가 발생할 수 있으므로, 내부망에는 침입 탐지를 목적으로 하는 IDS를 배치하는 것이 좋다. IDS는 포트미러링 방식으로 업무 데이터 흐름에 영향을 주지 않고 패킷을 분석하여 침입 여부를 탐지할 수 있기 때문이다. 참고로, IPS는 장애 시 업무에 영향을 줄 수 있으므로 bypass 기능을 지원해야 한다.
 
13. IPSec의 AH, ESP 보안 헤더에 대하여 전송모드/터널모드로 운영 시 인증구간, 암호화구간을 설명하고 키 교환 프로토콜명을 기술하시오.
 (1) AH 전송모드
  - 인증구간 : IP 헤더에서 전송 중 변경가능 필드(TTL, Checksum 등)를 제외한 IP 패킷 전체를 인증
  - 암호화구간 : 암호화 미지원
 (2) AH 터널모드
  - 인증구간 : New IP 헤더에서 전송 중 변경가능 필드를 제외한 New IP 패킷 전체를 인증
  - 암호화구간 : 암호화 미지원
 (3) ESP 전송모드
  - 인증구간 : ESP 헤더와 암호화된 데이터(IP Payload + ESP 트레일러)를 인증
  - 암호화구간 : IP Payload와 ESP 트레일러를 암호화
 (4) ESP 터널모드
  - 인증구간 : ESP 헤더와 암호화된 데이터(Original IP 헤더 + IP Payload + ESP 트레일러)를 인증
  - 암호화구간 : Original IP 패킷 전체(Original IP 헤더 + IP Payload) + ESP 트레일러)를 암호화
 (5) 키교환 프로토콜명 : IKE(Internet Key Exchange) 프로토콜
 
14. HearBleed 취약점 탐지를 위한 Snort Rule 설정의 의미를 설명하시오
alert tcp any any < > any (1)[443,465,523] ((2)content:"|18 03 00|"; depth: 3; (3)content:"|01|"; distance: 2; within: 1; 
(4) content:!"|00|"; within: 1; (5)msg: "SSLv3 Malicious Heartbleed Request V2”; (6) sid: 1;)
 - (1) 탐지 대상 포트 번호를 443, 465, 523으로 지정
 - (2) Content에서 첫 3바이트를 검사하여 바이너리 값으로 "18 03 00"이 있는지 검사
 - (3) (2)번이 끝난 위치에서 2바이트 떨어진 위치에서 1바이트를 검사하여 바이너리 값으로 "01"이 있는지 검사
 - (4) (3)번이 끝난 위치에서 바로 1바이트를 검사하여 바이너리 값으로 "00"이 포함되지 않는지 여부를 검사
 - (5) (1)~(4)의 탐지룰에 모두 매칭이 되는 경우 로그에 "SSLv3 Malicious Heartbleed Request V2"로 기록
 - (6) 해당 룰의 식별자를 1로 지정
 
15. 요청 헤더와 응답 헤더를 보여주며 공격에 대하여 질문에 답하시오
 (1) 공격의 이름은?
 (2) 공격이 성공했다는 근거는?
 (3) apache.conf 파일에서 보안 조치 방법은?
 - (1) 디렉터리 인덱싱
 - (2) 응답값이 200 OK이고 index of /cgi/bin 페이지가 성공적으로 조회되었기 때문임
 - (3) Options 지시자에 있는 indexes 값 삭제
 
16. Robot.txt 파일에 대하여 다음 물음에 답하시오
 (1) Robot.txt 파일의 용도
 (2) 아래 설정값의 의미
useragent : yeti
useragent : googlebot
(가) allow : /
useragent : googlebot-image
(나) disallow : /admin/
(다) disallow : /*.pdf$
 - (1) 검색엔진에서 자동 크롤링 도구에 대하여 접근 허용 여부를 제어하기 위한 파일
 - (2-가) 검색 엔진 로봇(yeti, googlebot)에 대하여 root 디렉터리(/) 미의 모든 파일 및 디렉터리의 크롤링을 허용
 - (2-나) 검색 엔진 로봇(googlebot-image)에 대하여 /admin 폴더 크롤링을 허용하지 않음
 - (3-다) 검색 엔진 로봇(googlebot-image)에 대하여 pdf 확장자를 가진 파일에 대하여 크롤링을 허용하지 않음
    
11. 유닉스 계정 패스워드 임곗값 설정에서 다음 옵션의 의미를 설명하시오.
deny=5, unlock_time=120, no_magic_root, reset
 - deny=5 : 인증 실패 임곗값을 5회로 설정(5회 실패 시 계정 잠김)
 - unlock_time=120 : 계정 잠김 후 마지막 인증 실패 시작으로부터 120초가 지나면 자동으로 계정 잠금 해제
 - no_magic_root : root 설정은 잠김 설정 예외
 - reset : 접속 시도 성공 시 실패 회수를 초기화함
 
12. /etc/shadow 파일에 대하여 다음 물음에 답하시오
(1) x:a$b$c: 에서 a,b,c의 의미는?
(2) b가 레인보우 테이블 공격에 대응할 수 있는 이유는?
(3) pwunconv 명령의 기능은?
 - (1) a : 암호화 알고리즘(1은 md5, 5는 sha256, 6은 sha512로 암호화), b : Salt 값, c : 해시값(salt + 암호를 입력으로 하여 산출된 해시값)
 - (2) 해시 연산 수행 시 salt 값을 추가 입력값으로 사용하는 경우 동일한 암호에 대하여 해시값이 달라지므로, 해시 목록을 이용한 레인보우테이블 공격에 대응 가능
 - (3) /etc/shadow의 패스워드 값이 /etc/passwd 파일의 패스워드 항목으로 들어가게 되며 shadow 파일은 비활성화 됨
 
13. 강제적 접근제어 모델에 대하여 다음 물음에 답하시오
(1) 정보의 불법적 파괴나 변조보다는 기밀성 유지에 초점을 둔 모델의 명칭은?
(2) no-read-up의 의미는?
(3) no-write-down의 의미와 보안적 관점에서의 의의는?
(4) 비바 모델의 write 정책은?
 - (1) BLP(벨라파둘라) 모델
 - (2) 보안 수준이 낮은 주체는 보안 수준이 높은 객체를 읽지 못하게 하여 기밀성을 보장하도록 함(주체는 객체와 동일하거나, 높은 등급일 때만 읽을 수 있음)
 - (3) 보안 수준이 높은 주체는 보안 수준이 낮은 객체에 기록해서는 안됨(보안적 관점에서는 높은 수준의 주체가 낮은 수준의 주체에게 정보를 전달할 수 있는 경로를 차단하여 기밀성을 보장하기 위한 목적에서 의의가 있음)
 - (4) no-write-up(정보수준이 낮은 주체가 높은 수준의 객체에 Blind 업데이트를 하지 못하도록 차단함으로써, BLP의 무결성 문제를 해결하기 위한 정책)
 
14. A시스템에서 B시스템으로 ACK 2012~2018 포트까지 패킷을 전송하여 2017 포트에서 reset 응답이 도착하였다. 이에 대하여 다음 물음에 답하시오
(1) 무슨 스캔인가?
(2) 스캔의 목적은?
(3) 본 스캔을 통하여 무엇을 알 수 있는가?
 - (1) TCP ACK 스캔
 - (2) 포트의 오픈 여부 판단이 아닌 방화벽과 같은 보안 장비의 필터링 수행 여부를 판별하기 위한 목적임(방화벽에서 필터링 되고 있으면 응답이 없거나 ICMP 메시지를 받고, 필터링 되고 있지 않다면 RST 응답을 받음)
 - (3) 2017 포트는 방화벽에서 필터링을 하지 않고 있음을 알 수 있음(2012~2016은 무응답이므로, 방화벽에 의해 필터링 되고 있음)
 
15. 아파치 설정에서 다음 옵션들의 의미에 대하여 설명하시오
(1) timeout 300
(2) maxkeepaliverequest 100
(3) Directoryindex index.htm, index.html, index.php
(4) ErrorLog "경로"
 - (1) 클라이언트와 서버 간에 300초(5분) 동안 아무런 메시지가 발생하지 않으면 타임아웃을 시키고 연결을 끊음
 - (2) Keepalive 값이 On인 경우 클라이언트와 연결된 작업의 최대 개수를 100개로 제한함. 해당 횟수를 초과하면 현재 프로세스는 종료하고 다른 프로세스가 처리함
 - (3) 웹 디렉토리 접근 시 인식되는 인덱스 파일의 순서를 index.htm, index.html, index.php 순으로 지정함
 - (4) Error 발생 시 로그 파일의 위치를 지정함

 16. XSS 공격을 탐지하기 위한 다음의 Snort rule에 대하여 다음 물음에 답하시오
Alert any any -> any 80 (msg:"XSS"; content:"GET"; offset:1; depth:3; content:"/login.php<script>XSS"; distance:1;
 (1) content:"GET"; offset:1; depth:3; 의 의미는?
 (2) content:"/login.php<script>XSS"; distance:1; 의 의미는?
 (3) 바이너리로 전송된 패킷(L이 대문자임)을 참고하여 위의 룰로 탐지가 안될 경우 어떻게 수정해야 하는지 기술하시오
 - (1) 전송된 패킷의 처음 1바이트를 띄우고 3바이트를 검사해서 GET 문자열을 찾으라는 의미
 - (2) 이전 메시지(GET)를 찾은 위치에서 1바이트를 띄우고 /login.php<script>XSS 문자열을 찾으라는 의미
 - (3) offset:1을 offset:0으로 변경하거나 offset 옵션을 삭제. 그리고 nocase 옵션을 추가하거나 login을 Login으로 변경
   
11. 다음 패킷을 ESP 터널모드로 전송하는 경우 다음 물음에 답하시오
 [IP 헤더] [TCP 헤더] [데이터]
(1) ESP 터널모드로 전송 시 추가되는 필드를 그림으로 도식화 하시오
(2) 암호화되는 필드의 범위를 설명하시오
(3) 인증되는 필드의 범위를 설명하시오
 - (1) [New IP 헤더][ESP 헤더][IP 헤더][TCP 헤더][데이터][ESP Trailer][ESP Auth]
 - (2) [IP 헤더][TCP 헤더][데이터][ESP Trailer]
 - (3) [ESP 헤더][IP 헤더][TCP 헤더][데이터][ESP Trailer]
 
12. 백도어가 설치되어 있는 것을 아래 보기로 확인하였으나, 해당 파일 경로로 가보니 파일이 존재하지 않았다.
[보기]
ls -al /proc/5900
exe -> 백도어경로(delete)
(1) 백도어 파일 경로로 접속 시 해당 프로세스가 보이지 않는 이유는?
(2) 삭제된 백도어 프로세스를 /tmp/backdoor로 복원하는 명령어는?
(3) 공격자가 사용한 명령어를 확인하는 방법은 무엇인가?(단, ps는 변조되어 사용 불가함)
 
 - (1) 공격자가 백도어 프로세스를 실행 후 해당 파일을 삭제 했기 때문
 - (2) cp /proc/5900/exe /tmp/backdoor
 - (3-1) history : 공격자가 로그인 후 입력했던 명령어들과 명령어 뒤에 입력한 parameter까지 확인 가능
 - (3-2) cat proc/5900/cmdline : 공격자가 백도어 프로세스를 실행시 사용한 명령어 확인 가능
 
13. 정보통신망법에 적용을 받는 신생회사에서 비밀번호 작성 규칙을 수립하려고 한다. 개인정보의 기술적, 관리적 보호조치 기준에 따른 비밀번호 작성규칙 3가지를 설명하시오
 - 패스워드 복잡도 및 길이 : 영문, 숫자, 특수문자 중 2종류 이상 조합시는 10자리 이상, 3종류 이상 조합시는 최소 8자리 이상의 길이로 구성
 - 유추하기 어려운 비밀번호 사용 : 연속적인 숫자나 생일, 전화번호 등 추측하기 쉬운 개인정보 및 아이디와 비슷한 비밀번호는 사용하지 않을 것을 권고
 - 패스워드 유효기간 설정 : 비밀번호에 유효기간을 설정하여 최소 반기별 1회 이상 변경
 
14. 백업 스크립트 파일과 백업 결과 파일은 다음과 같다. 아래의 질문에 답하시오
[백업 스크립트 파일]
#/bin/sh
tar -cvzf /data/backup/etc_$dat.tgz /etc/*
tar -cvzf /data/backup/home_$dat.tgz /home/*
[백업 결과 파일 권한]
rw-r--r-- root root /data/backup/etc_YYYYMMDD.tgz
rw-r--r-- root root /data/backup/home_YYYYMMDD.tgz
(1) 백업 결과 파일의 권한을 검토하여 어떤 문제가 있는지 설명하시오
(2) 백업 스크립트 파일에서 umask 변경 후 백업 파일을 생성하고, umask를 원래대로 만드는 스크립트를 작성하시오
(3) operator 사용자만 백업 스크립트(/usr/loacl/bin/backup)를 사용하도록 만드는 명령어를 기술하고, 해당 명령어에 대해 간단히 설명하시오
 - (1) root가 아닌 다른 계정들도 백업 파일을 읽을 수가 있음(/etc 밑에는 /etc/passwd, /etc/shadow와 같은 중요한 파일이 있어 기밀성이 보장되어야 함), 백업 파일은 소유자도 기본적으로 변경이 불가하게 읽기 권한으로 설정 권고
 - (2) umask 266
 - (3) chown operator /usr/local/bin/backup : 소유주를 operator로 변경
       chmod 700 /usr/local/bin/backup : 소유주만 스크립트에 대한 rwx가 가능하도록 권한 변경
 
15. 다음은 http request 메시지를 패킷 분석 tool로 캡쳐한 화면이다. 다음 물음에 답하시오
[패킷 캡쳐 화면 #1]
POST / HTTP/1.1
......
content-length : 1000000
[패킷 캡쳐 화면 #2]
......
TCP segment data (1byte)
(1) 어떤 공격이 시도되고 있는가?
(2) 해당 공격이라고 판단한 근거를 구체적으로 설명하시오
(3) 공격에 대한 서버측 대응 방안 2가지를 설명하시오
 - (1) Slow HTTP Post DOS (Rudy)
 - (2) 첫번째 화면에서 POST request에 대하여 콘텐츠 길이가 1000000이라는 큰 값으로 설정되어 있음. GET 방식과 달리 POST는 클라이언트가 서버로 전송할 데이터의 크기를 설정할 수 있으며, 서버는 콘텐츠 킬이만큼의 데이터가 수신될때까지 연결을 유지하고 대기하게 됨
       두번째 화면에서 POST data를 1바이트씩 쪼개서 분할 전송하고 있으므로, 서버는 1000000바이트의 데이터가 모두 도착할 때까지 연결을 장시간 유지하므로 가용량을 소진하게 되어 다른 클라이언트로부터의 정상적인 서비스 요청을 처리 불가능한 상태로 빠지게 됨
 - (3-1) 연결 타임아웃(Connection Timeout) 설정 : 클라이언트와 서버간 세션유지시간 초과 시 연결 종료
 - (3-2) 읽기 타임아웃(Read Timeout) 설정 : 지정한 시간내에 body 정보가 모두 수신되지 않으면 오류코드 반환
 - (3-3) IPTABLES와 같은 서버 방화벽 설정 : 동일한 소스 IP에서 동시 연결가능한 개수의 임계치를 설정하여 초과시 차단
 
16. OO시의 어르신 교통카드 신청서 안내문에서 개인정보보호법에 위반되는 사항 4가지 사항을 찾아서 설명하시오
(1) 개인정보 수집 및 이용 내역(필수) : 수집항목(주민등록번호 포함), 목적(본인확인), 기간(영구보관)
 * 동의를 거부할 권리가 있다는 사실 및 동의 거부 시 불이익 명시함.
(2) 제3자 제공 : 제공기관(유관기관), 제공내역(주민등록번호 포함), 제공목적, 기간(교통카드 만료시까지)
(3) 위탁 : 위탁기관(OO신용카드), 위탁업무(교통카드발급업무)
(4) 위 3가지 항목에 대하여 동의하는지 확인 요청
 - 주민등록번호 수집 및 3자 제공 불가(개인정보보호법 제24조의 2)
 - 개인정보 보관 기간이 영구로 설정
 - 제3자 제공 시 동의를 거부할 권리가 있다는 사실 및 거부에 따른 불이익에 대한 설명 누락
 - 제3자 제공 기관명칭이 불분명하게 기술
  
11. 쿠키(Cookie)는 개별 클라이언트 상태 정보를 HTTP 요청/응답 헤더에 담아서 전달하는 작은 정보 또는 데이터를 의미한다. 아래의 질문에 답하시오.
Set-Cookie: ID=KISA; Path=/; secure
(1) 쿠키의 속성을 위와 같이 설정하면 얻을 수 있는 효과는 무엇이며, (2) 이를 통해 방지할 수 있는 공격기법은 무엇인지 서술하시오.
(3) HttpOnly로 설정하면 응답 헤더의 내용이 어떻게 바뀌는지, (4) 이렇게 설정하면 얻을 수 있는 효과는 무엇이며, (5) 이를 통해 방지할 수 있는 공격기법에 대해서 서술하시오.
 - (1) secure 속성을 설정하는 것으로 클라이언트가 HTTPS 통신일 경우에만 해당 쿠키를 전송한다.
 - (2) 전송중에 평문 쿠키가 노출되는 것을 방지할 수 있어 기밀성을 보장할 수 있다.
 - (3) Set-Cookie: ID=KISA; Path=/; HttpOnly
 - (4) 자바 스크립트 등의 스크립트를 통해 해당 쿠키에 접근하는 것을 차단해준다.
 - (5) 크로스사이트스크립트(XSS) 공격에 대응할 수 있다.

 12. 디지털 포렌식 5원칙 중 3가지를 제시하고 그 내용을 기술하시오
 - (1) 정당성 원칙 : 증거가 적법절차에 의해 수집되어야 함
 - (2) 재현 원칙 : 같은 조건과 상황에서 항상 같은 결과가 나와야 함
 - (3) 신속성 원칙 : 전 과정이 신속하게 진행되어야 함(휘발성 데이터 등)
 - (4) 연계보관성 원칙 : 각 단계에서 담당자 및 책임자를 명확히 해야 함
 - (5) 무결성 원칙 : 수집된 증거가 위변조가 없어야 함
 
13. 스팸메일 차단 방법으로 SPF(Send Policy Framework)와 DKIM(DomainKeys Identified Mail)가 있다. 아래에 답하시오
(1) SPF의 동작 원리에 대해서 설명하고, (2) SPF에서 확인되지 않는 정보는 어떻게 얻어 올 수 있는지 설명하시오.
(3) DKIM에서 공개키를 전달하는 수단과 기법을 설명하시오.
(4) SPF와 DKIM 방식이 혼합된 형태의 기법은 무엇인가?
 - (1) 발신자는 자신의 메일 서버 정보와 정책을 적은 SPF 레코드를 해당 DNS에 등록하고 수신자는 이미 등록된 발신자의 SPF 레코드를 확인하여 수신한 메일에 표시된 IP와 비교하여 수신여부를 결정한다.
 - (2) DNS에서 읽어온다.
 - (3) 수신자는 DNS에 등록된 송신자의 공개키를 조회하여 확인하고 도메인 네임에 연결된 전자서명을 이메일 메시지에 첨부
 - (4) DMARC(Domain-based Message Authentication, Reporting and Conformance)
 
14. 아래에서 설명하는 보안취약점에 대해 질문에 답하시오
<예문1>
<?xml version="1.0"?>
<!DOCTYPE attack[
<!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<print> &xxe; </print>
<예문2>
<?xml version="1.0"?.
<!DOCTYPE lolz[
<!ENTITY lol "lol">
<!ELEMENT lolz (#PCDATA)>
<!ENTITY lol1 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">
<!ENTITY lol2 "&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;">
<!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">
<!ENTITY lol4 "&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;">
<!ENTITY lol5 "&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;">………
]>
<lolz>&lol9;</lolz>
(1) <예문1>에 제시된 공격기법의 이름을 적고, (2) <예문1>의 공격기법의 원리와 취약점을 서술하시오.
(3) <예문3> 코드를 실행했을 때 그 결과에 대해서 설명하시오
 - (1) XXE(XML eXternal Entity) 인젝션
 - (2) XML 문서 안에서 외부의 개체를 참조하게 되는데 이 때 외부 개체에서 삽입된 악의적인 코드가 실행되어 데이터 유출, 서비스 거부 공격 등을 수행할 수 있음
 - (3) 엔티티 참조를 반복하면서 메모리 고갈, 이로 인한 서비스 불가
 
15. 아래의 정량적 위험 분석에 대해 질문에 답하시오
구분	자산현황	대책
		A	B
자산 가치(만원)	100,000	100,000	100,000
노출계수(%)	80	20	80
SLE(만원)	( 1 )	( 2 )	( 3 )
ARO(%)	50	50	25
ALE(만원)	( 4 )	( 5 )	( 6 )
대책 적용 시 ALE감소(만원)	-      30,000     40,000
대책비용(만원)	         -       17,000	4,000
대책 적용 시 이익(만원)	-	( 7 )	( 8 )
(1) 위 표의 빈 칸에 알맞은 답을 기재하고, (2) 어느 보안 대책을 선택하여야 하는지, (3) 그 이유에 대해 서술하시오
 
 - (1) (1) 80,000, (2) 20,000, (3) 80,000, (4) 40,000, (5) 10,000, (6) 20,000, (7) -7,000, (8) 16,000
 - (2) B
 - (3) ALE보다 대책 적용 시 ALE 감소 금액이 커서 효과는 동일하나, 대책 적용에 드는 비용을 감안하면 B가 더 유리함
 
16. 아래의 공공기관 정보처리와 관련한 법적 취약점 4개를 제시하고, 그 이유를 서술하시오.
- 수집: 온라인 및 오프라인으로 개인정보의 수집 관련 항목이 기재되어 있고, 오프라인에는 수집 담당자가 기재되어 있음
- 보관: 전자적 형태로 저장된 개인정보에 대해서는 암호화가 적용되어 있으나, 문서형태로 저장되는 경우 캐비넷에 보관하고 암호화기법이 기재되어 있지 않음
- 이용: 접수된 민원서류에 대해 처리하고 통계자료로 활용하기 위해 개인정보항목들을 즉시 전송한다고 되어 있고, 주민번호가 포함되어 있으나 평문으로 전송하고 있음
- 파기: 파기된 정보의 보관기간이 영구로 기재되어 있음
 - (1) 수집 - 온라인(홈페이지) - 수집담당자 - 미설정 : 담당자 지정하여야 함
 - (2) 캐비넷 - 암호화기법 - 미설정 : 물리적 보안(잠금장치 등) 시행
 - (3) 통계 - 주민번호 - 평문전송 : 암호화하여야 함
 - (4) 파기 - 보관기간 - 영구 : 해당 민원서류의 보관기간 동안만 보관 or 파기 정보는 3년간 보관 후 삭제(제시된 보기에서는 DB에 저장되어 있음     

11. 알맞은 내용을 쓰시오
 (1) 가명정보의 정의와 가명처리 3번째 단계를 쓰시오
  - 가명정보 : 개인정보를 가명처리함으로써 원래의 상태로 복원하기 위한 추가 정보의 사용·결합 없이는 특정 개인을 알아볼 수 없는 정보
  - (A) 적정성 검토 및 추가처리
 (2) 가명처리를 할 때 정보주체 동의 없이도 수집 가능한 경우를 3가지 쓰시오
  - 통계작성, 과학적 연구, 공익적 기록보존
 (3) 가명정보를 사용할 필요가 없을 때 개인정보보호법에 해당되지 않는 (B)를 사용해야 한다. (B) 용어와 정의를 쓰시오.
  - 익명정보 : 시간·비용·기술 등을 합리적으로 고려할 때 다른 정보를 사용하여도 더 이상 개인정보를 알아볼 수 없는 정보
 
12. NAC(Network Access Control)의 물리적 구성 방법 두가지를 설명하고 특징을 쓰시오.
 - Inline(트래픽 경로에 배치) / Out of band(스위치의 일반포트나 미러링포트에 배치)
inline(실시간탐지 및 차단이 유리함/장비의고속패킷처리필요 및 장애발생시 서비스영향(SPOF 위험)
out-of-band(네트워크의 물리적재구성이 필요없어 구축이 용이/실시간성이 떨어짐)
 - Agent / Agentless
 
13. 정보보호 최고책임자의 역할 및 책임(R&R) 4가지를 쓰시오
 - 정보보호관리체계의 수립 및 관리·운영
 - 정보보호 취약점 분석·평가 및 개선
 - 침해사고의 예방 및 대응
 - 사전 정보보호대책 마련 및 보안조치 설계·구현 등
 - 정보보호 사전 보안성 검토
 - 중요 정보의 암호화 및 보안서버 적합성 검토
 - 그 밖에 이 법 또는 관계 법령에 따라 정보보호를 위하여 필요한 조치의 이행
 
14. 다음 웹 로그를 보고 알맞은 내용을 쓰시오
시간 192.168.0.11 192.168.0.30 get /script/..%c0%80%ef../winnt/system32/cmd.exe?/c+dir 404 420 324 HTTP 1.0
 (1) 어떤 취약점을 이용한 공격 시도인가?
  - 웹서버 폴더 통과(Web Server Folder Traversal) 취약점
 (2) 공격 성공 유무 및 이유를 쓰시오
  - 실패, 404코드가 반환된 것으로 보아 파일의 정확한 위치 파악하지 못함
 (3) 대응 방안을 2가지 쓰시오
- 정해지지 않은 폴더에 접근할 수 없도록 Permission설정
- 이상입력값을 입력하지 못하도록 에러처리
- IIS서버 패치
 
15. 각각의 Snort Rule 설정의 의미를 작성하시오.
 (1) msg:"GET Flooding"
  - alert 발생 시 GET Flooding이 이벤트 이름으로 사용된다.
 (2) content:"GET / HTTP1."
  - GET / HTTP1. 문자열을 검사한다.
 (3) content:"USER"; content:!"anonymous"
  - 문자열이 USER을 포함하고 anonymous를 포함하지 않는지 검사한다.
 (4) content:"|00|";depth:1
  - 1바이트의 바이너리 값이 00인지 검사한다.
 
16. 다음과 같이 Apache 설정 시 발생할 수 있는 문제점 두가지를 작성하고 대응방안을 쓰시오.
<Directory />
Options FollowSymLinks
AllowOverride none
Require all granted
</Directory>
<Directory /var/www>
Options indexes FollowSymLinks
AllowOverride none
Require all granted
</Directory>
 (1) 발생하는 두가지 문제점
  - 디렉터리 리스팅으로 웹 서버 구조 및 중요 파일 노출됨
  - 상위 디렉터리로 이동하여 악의적인 접근 가능함
(2) 두가지 문제점에 대한 대응방안
  - /var/www 디렉터리의 Options 지시자에서 Indexes 옵션 제거
- AllowOverride 옵션을 None → AuthConfig로 변경

 11. SQL Injection을 예방하기 위한 prepared statement에 대하여 다음 물음에 답하시오
 (1) prepared statement의 개념
 - (1) 최초에 한번 쿼리를 분석해 최적화 수행 후 메모리에 저장해두고, 다음 요청부터는 저장된 결과를 재사용하여 쿼리를 수행하는 방식이다. 성능 측면의 효율이 높고, SQL 인젝션 방지가 가능하다. 참고로 일반 statement 방식은 실행시마다 쿼리를 분석해 최적화 수행 후 실행하는 방식이라 효율이 낮고 SQL Injection 공격에 취약하다.
 (2) prepared statement가 SQL Injection 공격을 막을 수 있는 이유
 - (2) 사용자가 입력한 값이 SQL 명령의 일부가 아닌 매개 변수로 처리되기 때문에 SQL 인젝션 공격을 막을 수 있다.
e.g.) statement 방식
String query = "INSERT into student VALUES("' + user + '")";
Statement stmt = conn.createStatement();
stmt.executeQuery(quert);
user에 Robert');DROP table students;-- 값을 입력하면 다음과 같이 SQL명령문의 일부로 처리되어 students 테이블이 drop되게 됨.
INSERT into student VALUES('Robert');DROP table students;--')
e.g.) preparedstatement 방식
PreparedStatement stmt = conn.preparedStatement("INSERT into student VALUES(?)");
stmt.setString(1, user);
stmt.execute();
user에 Robert');DROP table students;-- 값을 입력하더라도 해당 값이 그대로 매개변수로 user 컬럼에 입력 됨
 
12. DRDoS에 대하여 다음을 설명하시오
 1) DRDoS의 공격 원리
  공격자는 소스 IP를 공격대상의 IP로 위조하여 다수의 반사서버로 요청을 보내고, 공격대상 서버는 반사서버로부터 다수의 응답을 받아 서비스 거부 상태에 빠짐
 2) 기존 DoS와의 차이점
  a) 출발지 IP가 위조되고, 반사서버를 통해 공격이 수행되므로 공격의 출처를 파악하기 어려움
  b) 다수의 좀비 PC를 동원하지 않더라도 대량의 공격 패킷을 만들어낼 수 있어 효율이 높음
 3) Unicast RPF
  인터페이스를 통해 들어오는 패킷의 IP에 대하여 라우팅 테이블을 확인하여 들어온 인터페이스로 나갈 수 있는 Reverse Path가 존재하면 통과시키고, 존재하지 않으면 IP가 위조된 것으로 판단하고 차단시킴
 
13. 패킷 필터링 방화벽과 관련하여 다음 물음에 답하시오.
 1) 존재하지 않는 외부 IP를 이용한 Spoofing 공격에 대응하기 위한 패킷 필터링 방화벽 기술의 이름과 원리
 - 1) Ingress 필터링 : 인터넷 상에서 사용되지 않는 IP 대역은 들어오지 못하게 차단함
 2) 공격자가 패킷을 소형 단편화하여 tiny fragment 공격을 수행하는 이유
 - 2) 쪼개진 패킷을 재조합하는 기능을 제공하지 않는 방화벽의 경우 이렇게 다수로 쪼개진 패킷을 탐지하거나 차단할 수 없는 약점이 있기 때문이다.
 3) Tiny fragment 공격 대응 방법
 - 3-1) 단편화된 패킷을 재조합하는 기능이 있는 방화벽을 사용
 - 3-2) Port 번호가 포함되어 있지 않을 정도로 분할된 패킷은 필터링 장비(IDS, IPS)에서 탐지 or 차단
 4) stateful 패킷 필터링과 일반 패킷 필터링 방화벽의 차이점
 - 4-1) 일반 패킷 필터링 방화벽은 지나가는 패킷 헤더안의 IP 주소와 Port 주소만을 단순검색하여 통제함. Tiny Fragment와 같은 공격에 취약하나 처리 속도는 빠름
 - 4-2) Stateful 패킷 필터링 방화벽은 동일한 IP주소, 출발지 포트 번호, 목적지 IP주소, 목적지 포트 번호 상태 등을 갖는 패킷들의 상태를 저장하고 그룹으로 필터링함으로써 일반 패킷 필터링 방식보다 신뢰성 높고 정교하게 공격을 막을 수 있음. 예를 들어 SYN 요청을 통해 Establish가 되지 않은 상태에서 Establish된 것처럼 조작된 패킷은 차단 가능함.
 
14. 다음은 email 관련 로그이다. 이에 대하여 다음 물음에 답하시오.
1 Delivered-To: hbiden@rosemontseneca.com
2 Received: by 10.36.47.149 with SMTP id j143csp13601itj;
3 Fri, 17 Apr 2015 06:00:53 -0700 (PDT)
4 X-Received: by 10.55.27.42 with SMTP id b42mr5166039qkb.53.1429275653296;
5 Fri, 17 Apr 2015 06:00:53 -0700 (PDT)
6 Return-Path: <v.pozharskyi.ukraine@gmail.com>
7 Received: from mail-qc0-x232.google.com (mail-qc0-x232.google.com. [2607:f8b0:400d:c01::232])
8 by mx.google.com with ESMTPS id u123si11512941qhd.83.2015.04.17.06.00.52
9 for <hbiden@rosemontseneca.com>
10 (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
11 Fri, 17 Apr 2015 06:00:53 -0700 (PDT)
12 Received-SPF: pass (google.com: domain of v.pozharskyi.ukraine@gmail.com designates 2607:f8b0:400d:c01::232 as permitted sender) client-ip=2607:f8b0:400d:c01::232;
13 Authentication-Results: mx.google.com;
14 spf=pass (google.com: domain of v.pozharskyi.ukraine@gmail.com designates 2607:f8b0:400d:c01::232 as permitted sender) smtp.mail=v.pozharskyi.ukraine@gmail.com;
15 dkim=pass header.i=@gmail.com;
 1) 10번째 줄에서 RSA의 용도는?
 - 1) 인증서(서버 공개키) 검증을 위하여 사용됨. 즉, TLS로 암호화통신을 하기 위하여 ECDHE로 키교환을 하는 과정에서 생성되는 변수를 송신자의 개인키로 서명하고, 공개키로 검증하도록 함으로써 송신자의 정당성을 인증하기 위함. 이를 통하여 키교환 과정에서의 중간자 공격을 막을 수 있음.
cipher에서 ECDHE는 키교환, RSA는 인증, AES128로 암호화, GCM(Galois/Counter Mode)으로 블록암호화 운영방식 선택, SHA256으로 메시지 인증(무결성 검증)을 의미함.
 2) 이메일 로그에서 확인할 수 있는 스팸메일 대응 기법명과 동작원리를 설명하시오.
 - 2-1) SPF : 이메일 발송도메인의 DNS에 txt레코드로 등록된 IP주소와 실제메일의 송신 IP를 비교하여 메일 도메인의 정당성을 검증
 - 2-2) DKIM : 이메일 서버의 개인키로 이메일 헤더를 전자서명하고, 메일 도메인서버의 txt레코드로 등록된 공개키로 검증하도록 함으로써, 메일 헤더가 변조되지 않았고 실제 해당 도메인에서 발송된 것을 확인 가능
 
15. 리눅스의 보안 설정과 관련하여 다음 물음에 답하시오.
 1) 계정임계값을 설정하는 파일명 (A)와 (B)에 들어갈 설정값을 기술하시오.
  auth required /lib/security/pam_tally.so (B) = 5 unlock_time=120, no_magic_root reset
 - 1-A) /etc/pam.d/system-auth or /etc/pam.d/common-auth
 - 1-B) deny
 2) IPTable에 신규 정책을 등록하여고 한다. 패킷을 차단하기 위해 (C)에 들어갈 옵션은 무엇인가?
  #iptables -A INPUT -p tcp -s 172.30.1.55 --dport 21 -j (C)
 - 2-C) DROP
 3) /etc/shadow 파일의 소유자를 root로 변경하고(D), 소유자에게만 읽기 권한을 부여(E)하기 위한 명령어를 기술하시오.
 - 3-D) chown root /etc/shadow
 - 3-E) chomd 400 /etc/shadow
 4) 다음 아파치 설정에서 Limitrequestbody 5000000의 의미(F)를 설명하시오.
<Directory "var/www/html/uploads">
Limitrequestbody 5000000
</Directory>
 - 4-F) 아파치 웹서버에 업로드 가능한 파일의 크기를 5,000,000바이트(약 5M바이트)로 제한함으로써 악의적인 웹 쉘 업로드를 방지하기 위한 설정
 
16. 특정 공격과 관련된 로그를 보고 다음 물음에 답하시오.
[로그]
DNS standard query 0x2872 ANY cpsc.gov United states Korea, Republic of
DNS standard query 0x2872 ANY cpsc.gov United states Korea, Republic of
DNS standard query 0x2872 ANY cpsc.gov United states Korea, Republic of
DNS standard query 0x2872 ANY cpsc.gov United states Korea, Republic of
 1) 어떤 공격이 수행된 것인가?
 - 1) DNS 증폭 DoS 공격(DNS amplification DoS attack)
 2) 해당 공격이 수행된 것으로 판단한 이유는?
 - 2) DNS query 수행시 ANY 타입으로 질의를 다수 수행하였음
 3) 해당 공격의 원리는?
 - 3) 출발지 IP를 공격 대상 서버의 IP로 위조 후 DNS 쿼리 타입을 ANY로 지정하여 request를 대량으로 수행하면, 다양한 TYPE의 레코드들이 모두 Response 되므로 응답이 증폭되어 공격 대상 서버에 부하를 주게됨
 4) 공격자들이 이 기법을 사용하는 이유 두 가지는?
 - 4-1) 출발지 IP가 위조되고, 반사 서버를 통해 공격이 수행되므로 공격의 출처를 파악하기 어려움. 특히 UDP는 별도의 인증 절차가 없으므로 공격 수행이 용이함
 - 4-2) 다수의 좀비PC를 동원하지 않더라도 대량의 공격 패킷을 만들어낼 수 있어 효율이 높음. 특히 쿼리 타입을 any나 txt로 하면 response 사이즈가 증폭되어 작은 사이즈의 DNS 질의에 대해 큰 사이즈의 DNS 응답 메시지가 발생되어 증폭 효과가 큼. 90바이트 질의, 3370바이트 응답(37.4배 증폭 효과)

 
11. 특수비트와 관련하여 다음 각 항목에 설정된 접근권한의 의미를 설명하시오.
 1) -r-sr-xr-x root sys /etc/chk/passwd
  - /etc/chk/passwd 파일은 owner의 실행권한이 s이므로 setuid 설정이 되어있다. 따라서, 일반 사용자 계정으로 해당 파일을 실행하더라도 소유자인 root의 권한으로 실행된다.
 2) -r-xr-sr-x root mail /etc/chk/mail
  - /etc/chk/mail 파일은 Group의 실행권한이 s이므로, setgid 설정이 되어있다. 따라서, 일반 사용자 계정으로 해당 파일을 실행하더라도 mail 그룹의 권한으로 실행된다.
 3) drwxrwxrwt sys sys /tmp
  - /tmp 디렉토리는 모든 사용자가 읽기, 쓰기, 실행이 가능하도록 777로 권한설정이 되어 있으며, 추가적으로 Others의 실행 권한이 t이므로 sticky bit가 설정되어 있다. 따라서 /tmp 디렉토리에는 누구나 파일을 생성, 수정 및 읽기가 가능하나, 파일의 소유자 및 root 계정 외에는 삭제가 불가하다.
 
12. 공공기관에서 개인정보처리 방침 수립 시 포함해야 할 사항을 4가지 이상 기술하고, 수립된 개인정보처리방침을 알리는 방법을 3가지 이상 기술하시오.
 - 개인정보처리 방침 수립 시 포함해야할 사항 4가지 이상
  1. 개인정보의 처리목적
  2. 개인정보의 처리 및 보유기간
  3. 개인정보의 제3자 제공에 관한 사항(해당되는 경우에만)
  3-2. 개인정보의 파기절차 및 파기 방법
  4. 개인정보처리의 위탁에 관한 사항(해당되는 경우에만)
  5. 정보주체 및 법정 대리인의 권리, 의무 행사방법에 관한 사항
  6. 개인정보보호책임자의 성명 또는 개인정보보호 업무 및 관련 고충사항을 처리하는 부서의 명칭과 전화번호 등 연락처
  7. 인터넷 접속파일 등 개인정보를 자동으로 수집하는 장치의 설치 운영 및 그 거부에 관한 사항(해당되는 경우에만)
  8. 그 밖에 개인정보의 처리에 대하여 대통령령으로 정한 사항
   1) 처리하는 개인정보의 항목
   2) 개인정보보호법 시행령 제30조 또는 제48조의 2에 따른 개인정보의 안전성 확보 조치에 대한 사항
 - 알리는 방법 3가지 이상
  1. 개인정보처리자의 인터넷 홈페이지
  2. 개인정보처리자의 사업장등의 보기 쉬운 장소에 게시하는 방법
  3. 관보(개인정보처리자가 공공기관인 경우만 해당한다)나 개인정보처리자의 사업장 등이 있는 시, 도 이상의 지역을 주된 보급지역으로 하는 '신문 등의 진흥에 관한 법률' 제2조제1호가목, 다목 및 같은 조 제2호에 따른 일반일간신문, 일반주간신문 또는 인터넷신문에 싣는 방법
  4. 같은 제목으로 연 2회 이상 발행하여 정보주체에게 배포하는 간행물, 소식지, 홍보지 또는 청구서 등에 지속적으로 싣는 방법
  5. 재화나 용역을 제공하기 위하여 개인정보처리자와 정보주체가 작성한 계약서 등에 실어 정보주체에게 발급하는 방법
 
13. 아래의 로그와 관련하여 물음에 답하시오.
device eth0 entered Promiscuous mode
 1) Promiscuous mode의 의미는?
  - 네트워크 카드의 eth0 인터페이스로 들어오는 모든 패킷을 수신하게 됨(수신자가 eth0로 설정된 패킷이 아니더라도 Drop하지 않고 모두 읽게 됨)
 2) 해당 모드로 진입 시 수행 가능한 공격은?
  - 패킷 스니핑 공격
 3) 공격에 대응할 수 있는 방법을 1가지 이상 설명하시오.
  - 통신 시 SSH, HTTPS 같은 암호화 통신 수행
  - ifconfig [인터페이스 명] -promisc 설정으로 무차별 모드 해제(악의적인 목적을 가진 단말 소유자가 자신의 NIC를 무차별 모드로 설정했다면 유효한 대응 방법이 아님)
  - 허브가 아닌 지능형 스위치 운용을 통하여 불필요한 브로드캐스팅 최소화
 
14. 정보 자산의 구성도와 자산목록을 보고, 1) 자산 식별의 문제점 1개와 2) 보안 취약 문제점 1개를 설명하시오.
[구성도]
 - 인터넷과 내부망 사이에 방화벽을 통하여 DMZ zone을 구성하고 web서버, mail서버가 배치되어 있음
 - web 서버 앞단에는 추가적으로 웹방화벽이 배치되어 있음
 - 내부망 내에서도 방화벽을 통하여 업무망, VDI망, 서버망으로 Farm이 분리되어 있음
 - 서버망 내에 dns서버, db서버, was서버, 개발서버가 위치하고 있음
[자산목록]
 - db서버 : OS(AIX 6.4), 호스트명(krserver1), 관리책임자(홍과장)
 - was서버 : OS(AIX 8.0), 호스트명(krserver1), 관리책임자(김부장)
 - dns서버 : OS(AIX 6.4), 호스트명(dns_srv), 관리책임자(홍대리)
 - web서버 : OS(Windows 2003), 호스트명(web1), 관리책임자(김부장)
 - mail서버 : OS(CentOS 7), 호스트명(krmail01), 관리책임자(김사원)
1) 자산 식별의 문제점 : 개발 서버가 자산 목록에서 누락되어 있음
 - 자산 식별이 안된 호스트는 자산 중요도 산정, 위험 평가를 통한 보안 통제적용의 사각지대에 놓이게 되므로 보안 위협에 쉽게 노출될 가능성이 높음
2) 보안 취약 문제점 : db서버, dns서버, web서버가 EOS된 버전의 OS를 사용하고 있음
 - 취약점에 대한 패치가 불가하고, 이슈 발생 시 기술지원이 불가하므로 업무 연속성에 문제가 발생할 가능성이 높음. 

※ 기타 추가 문제점
1) 개발서버와 운영서버가 동일한 서버망내에 위치함
 - 개발서버에 존재하는 취약점(악성코드)이 운영서버로 쉽게 전파 가능
 - 호스트내에서 tcp wrapper와 같은 ACL 통제 미적용 시, 개발서버와 운영서버간 jump host를 통해 코드 무단 배포, 정보 유출 위험이 높아짐
2) DB서버와 WAS서버의 호스트명이 동일함
 - 로그 모니터링 및 취약점 스캔 결과 확인 시 정확히 어떤 호스트에서 발생한 이벤트/취약점인지 식별하기 어려우므로 신속한 대응 및 조치가 불가함
 
15. 파일 업로드 취약점 대응을 위한 .htaccess 파일 설정의 의미에 대하여 답하시오.
1) <FilesMatch \. (ph|lib|sh|)>
Order Allow DENY
Deny From ALL
</FilesMatch>
2) AddType texy/html .php .php1 .php2 .php3 .php4 .phtml
 1) FileMatch 지시자를 이용, .ph, .lib, .sh 등의 Server Side Script 파일에 대해서 직접 URL 호출 금지(업로드된 스크립트(웹쉘)의 실행을 방지하기 위한 목적임)
 2) AddType 지시자를 이용 Server Side Script 확장자를 실행불가한 text/html MIME Type으로 재조정하여 업로드된 스크립트 실행 방지
 
16. 다음 위험평가서 양식과 관련하여 물음에 답하시오.
자산명	자산 중요도(C, I, A)	우려사항	가능성	위험도(C, I, A)
1) ERP 데이터	H, H, M	DB의 접근 통제 위반이나 위반 시도를 적시에 발견하여 처리할 수 없다	H	H, H, M
2) 워드문서	L, L, L	적절한 보안 규정이 부족하여 자산이 제대로 보호되지 않을 수 있음	M 	L, L, L
1) 자산 중요도 평가의 목적은?
 - CIA 측면에서 자산의 가치를 평가하여 중요도를 산정함으로써 정보보호의 우선순위를 결정할 수 있는 기준을 마련하기 위함
2) 해당표내 우려사항이란 무엇인가?
 - 자산에 발생할 수 있는 위협과 취약성을 하나의 통합된 고려요소로 평가하도록 하고 이를 '우려사항'이라는 용어로 표현함
3) 해당표내 가능성이란 무엇인가?
 - 기존에 설치된 보호대책을 고려하여 현재 시점에서 이러한 위협과 취약성이 발생하여 영향을 미칠 가능성을 의미함
4) 아래 자산 평가 테이블을 보고, 응시자 입장에서 나름대로 위험분석기법을 적용하여 위험분석을 수행하시오.
자산명	설명	소유자	자산 중요도(C, I, A)
1) ERP 데이터	ERP에서 사용하는 DB데이터	관리팀장	H, H, M
2) ERP 서버	ERP 프로그램이 탑재된 시스템	관리팀장	H, H, M
3) 워드문서	문서작성을 위한 임시문서	관리팀장/생산부장	L, L, L
 - 복합접근방법(Combined approach) 적용, 자산 중요도 값을 기준으로 고위험군(ERP)과 저위험군(워드문서)을 식별하여, 고위험군은 상세 위험분석을 수행하고, 저위험군은 베이스라인 접근법을 사용하여 위험분석을 수행한다.
   
11. 개인정보 최소수집 원칙에 의거하여 개인정보 수집이 가능한 경우 4가지를 기술하시오.
 1) 정보주체의 동의를 받은 경우
 2) 법률에 특별한 규정이 있거나 법령상 의무를 준수하기 위하여 불가피한 경우
 3) 공공기관이 법령 등에서 정하는 소관업무의 수행을 위하여 불가피한 경우
 4) 정보주체와의 계약의 체결 및 이행을 위하여 불가피하게 필요한 경우
 5) 정보주체 또는 그 법정대리인이 의사 표시를 할 수 없는 상태에 있거나 주소불명 등으로 사전 동의를 받을 수 없는 경우로서 명백히 정보주체 또는 제3자의 급박한 생명, 신체, 재산의 이익을 위하여 필요하다고 인정되는 경우
 6) 개인정보처리자의 정당한 이익을 달성하기 위하여 필요한 경우로서 명백하게 정보주체의 권리보다 우선하는 경우. 이 경우 개인정보처리자의 정당한 이익과 상당한 관련이 있고 합리적인 범위를 초과하지 아니하는 경우에 한한다.
 
12. 스위칭 허브의 기능 및 동작 원리에 대하여 서술하시오..
 - 스위칭 허브의 기능 : 패킷의 목적지 주소(MAC, IP, Port 등)를 확인하여, 목적지가 연결된 스위치의 포트로만 패킷을 전송하는 장치로 패킷의 고속 전송, 로드 밸런싱, QoS 기능을 수행
 - 동작원리
  1) Learning : 출발지의 MAC 주소를 확인하여 수신된 포트번호와의 매핑 정보를 스위치의 MAC Address Table에 저장(MAC주소 + 스위치 포트번호)
  2) Forwarding : 목적지 MAC 주소가 스위치의 MAC Address Table에 있는 경우, 목적지 주소에만 프레임을 전달
  3) Filtering : 출발지와 목적지가 같은 세그먼트(인터페이스)에 존재하는 경우 다른 세그먼트와 연결된 포트로 넘어가지 않도록 제어
  4) Flooding : 목적지 MAC 주소가 스위치의 MAC Address Table에 없는 경우 수신된 포트를 제어한 모든포트로 Broadcast 수행
  5) Aging : 설정된 Timer 시간(예:300초)동안 저장된 MAC 주소를 가진 프레임이 들어오지 않으면 MAC Address Table에 저장된 정보를 삭제
 
13. 다음과 같은 Snort 룰로 탐지된 패킷을 보고, 어떤 공격이 수행되었는지 설명하시오.
[Snort Rule]
alert tcp any any -> any 21 {content:"anonymous"; nocase; msg:"Anonymous FTP attempt"; sid:1000012}

[탐지 패킷]
TCP TTL:64 TOS:0x10 ID:5450 IpLen:20 DgmLen:68 DF
***AP*** Seq: 0xR95B8593 Ack: 0x7D3F3893 Win:0x1D TcpLen:32
TCP options (3) => NOP NOP TS: 45113 1572881
55 53 45 52 20 41 6E 4F 6E 59 6D 4F 75 53 0D 0A  USER AnOnYmOuS..
 - Anonymous FTP 공격이 수행되었음.
 - 공격자는 열려있는 ftp 서비스(포트 21)에 접속 후, 보안시스템의 탐지를 우회하기 위하여 계정명에 대소문자를 혼합한 AnOnYmOuS를 입력하여 로그인을 시도하였음.
 - Snort rule에서 nocase로 대소문자를 구분하지 않았기 때문에, 공격시도에 대한 탐지가 가능하였음.
 - Anonymous FTP 서비스가 enable된 경우, 서버에 계정이 없는 사용자도 접근이 가능하므로 서버내 권한 관리가 적절히 이루어지지 않을 경우 악성코드를 업로드 하거나 중요 파일에 접근 가능한 리스크가 있음. 따라서 꼭 필요한 경우가 아닌 경우 anonymous ftp 서비스는 disable 해야 함.
 
14. 스팸메일 릴레이 제한 설정과 관련하여 다음 ( )에 들어갈 명칭을 기술하시오.
# cat /etc/mail/(1) | grep "R$\*" | grep "Relaying denied"
R$*   $#error $@5.7.1 $ : "550 Relaying denied"
# cat /etc/mail/access
localhost.localdomain RELAY
localhost RELAY
127.0.0.1 RELAY
spam.com (2) # Relay를 허용하지 않음
# (3) hash etc/mail/(4) < etc/mail/access
 (1) sendmail.cf
 (2) REJECT (or DISCARD)
 (3) makemap
 (4) access.db (or access)
 
15. Smurf attack을 방지하기 위하여, 신뢰 할 수 있는 네트워크 범위(192.168.1.0/24)에서 시작하는 UDP 패킷으로 ip direct broadcast를 제한 설정하는 라우터 명령어를 기술하시오.
(config)# (A)
(config)# (B)
(config-if)# (C)
^z
Router#
 (A) : access-list 100 permit udp 192.168.1.0 0.0.0.255 any
 (B) : interface FastEthernet 0/0
 (C) : ip directed-broadcast 100
 
16. 위험 대응 기법과 관련하여 다음 물음에 답하시오.
 1) 위험수용의 의미는?
  - 위험의 정도가 수용 가능한 수준이라 판단하고 프로세스를 그대로 유지하거나 사업을 추진 
 2) 위험감소를 위한 보안 대책 선정 시, 특정 보안대책의 평가기준을 결정하는 정량적인 방법은?
  - 정보보호 대책의 효과(가치)는 보호대책 적용으로 감소한 연간손실예상액(ALE)에서 정보보호 대책 운영 비용을 뺀 금액을 계산하여 값이 높을수록 상대적으로 효과적인 정보보호 대책임
계산공식 : 3번 값이 높은 보호대책을 선정하는 것이 효과적임
1. 적용후 SLE(단일 손실예상액) = AV(자산가치) * EF(노출계수)
2. 적용후 ALE(연간 손실예상액) = SLE * ARO(연간발생률)
3. 보호대책의 효과(가치) = 감소한 ALE(적용전 ALE - 적용후 ALE) - 보호대책 운영 비용
 3) 위험회피시 위험이 있는 프로세스나 사업은 어떻게 대처하는가?
  - 위험이 있는 프로세스나 사업은 축소 또는 포기하는 방향으로 추진한다.
 4) 위험전가를 위한 2가지 방법은?
  - 보험가입 또는 외주(보안, 소방 업체) 위탁
    
11. IDS에서 사용하는 침입탐지 방식에 대하여 다음 물음에 답하시오.
1) 오용 탐지의 정의
2) 이상 탐지의 정의
3) 오용 탐지의 장점
4) 오용 탐지의 단점
 - 1) 잘 알려져 있는 공격(오용, misuse) 패턴을 룰로 등록 후, 패턴(시그니처)과 일치여부를 비교하여 침입여부를 판단하는 방식
 - 2) 정상 행위와 이상 행위(anomaly)를 프로파일링 후, 통계적 분석을 통하여 침입여부를 판단하는 방식
 - 3) 등록된 공격패턴에 의하여 탐지되므로 오탐률이 낮음
 - 4) 패턴에 없는 새로운 공격은 탐지가 불가하며, 새로운 공격 탐지를 위하여 지속적으로 패턴 업데이트를 해야 함
 
12. 재해복구시스템 유형에는 미러사이트, 핫사이트, 웜사이트, 콜드사이트가 있다. 다음 물음에 답하시오.
1) 미러 사이트의 정의
2) 미러사이트의 장단점 각 2개씩 설명
3) RTO가 가장 오래 걸리는 방식은 무엇이며, 이유는 무엇인가?
 - 1) 주센터와 동일한 수준의 시스템을 백업센터에 구축하고, 액티브-액티브 상태로 실시간 동시 서비스를 제공하는 방식
 - 2-1) 장점 : 신속한 업무재개 가능(RTO : 즉시), 데이터의 최신성 보장(RPO : 0)
 - 2-2) 단점 : 초기 투자 및 유지보수 비용이 높음, 데이터 업데이트가 많은 경우 과부하 초래
 - 3) 콜드사이트, 데이터만 원격지에 보관하고 서비스를 위한 정보자원은 최소한으로 확보되어 있어, 재해 시 필요한 자원을 조달하여 복구하는데 오랜 시간이 소요됨.
 
13. 개인정보의 기술적, 관리적 보호조치 기준에 포함된 개인정보취급자의 비밀번호 작성규칙 3가지를 기술하시오.
 - 패스워드 복잡도 및 길이 : 영문, 숫자, 특수문자 중 2종류 이상 조합시에는 10자리 이상, 3종류 이상 조합시에는 최소 8자리 이상의 길이로 구성
 - 유추하기 어려운 비밀번호 사용 : 연속적인 숫자나 생일, 전화번호 등 추측하기 쉬운 개인정보 및 아이디와 비슷한 비밀번호는 사용하지 않을 것을 권고
 - 패스워드 유효기간 설정 : 패스워드에 유효기간을 설정하여 최소 반기별 1회 이상 변경
 
14. 동일한 출발지 IP에서 2초동안 80번 포트로 30개 이상 SYN 요청이 들어오는 경우 차단하는 IPtables 룰을 작성하시오. (룰 옵션을 5개로 구분하여 설명하시오)
 - iptables -A INPUT -p TCP --syn --dport 80 -m recent --update --seconds 2 --hitcount 30 --name SYN_DROP -J DROP
 1) -A INPUT : inbound 요청에 대하여
 2) -p TCP --syn : TCP syn 패킷이 들어오는 경우
 3) --dport 80 : 목적지 포트가 80인 경우
 4) -m recent --update --seconds 2 --hitcount 30 --name SYN_DROP : 동일한 IP에서 2초동안 30번 이상 요청오는 경우
 5) -J DROP : 차단한다.
 
15. 정량적 위험평가 방법인 ALE와 관련하여 다음 물음에 답하시오.
1) SLE의 정의
2) SLE 계산 공식
3) ALE 계산을 위해 필요한 정보는 무엇인가?
4) 연간 손실이 완전 제거되는데 투입된 비용이 X라 할 때, 문제에서 언급된 변수만으로 ROI(%)를 구하는 계산식은?
 - 1) 한번의 사건으로 발생 가능한 손실액
 - 2) AV(Asset Value, 자산 가치) * EF(Exposure Factor, 노출계수)
 - 3) SLE에 ARO(Annual Rate of Occurence)를 곱하여 계산
 - 4) (ALE - X) / X * 100
 
16. MASTER와 SLAVE DNS 서버의 존파일 설정과 관련하여 다음 물음에 답하시오.
Master name 서버 : ns1.korea.go.kr (192.168.1.1)
Slave name 서버 : ns2.korea.go.kr (192.168.1.2)
1) Master DNS 서버의 zone 파일 설정을 위하여 다음 ( )에 들어갈 설정 값을 쓰시오.
/etc/named.conf
zone "korea.go.kr" IN {
         type (A);
         file "korea.go.kr.db";
         allow-update {(B)};
};

/var/named/korea.go.kr.db
$TTL 1000
@  IN SOA ns1.korea.go.kr master.korea.go.kr. (
                             2022113001 ; serial
                             21600 ; refresh
                             3600 ; retry
                             604800 ; expire
                             3600 ) ; minimum
    IN NS ns1.korea.go.kr.
    IN NS ns2.korea.go.kr.
ns1 IN A (C)
ns2 IN A (D)
 - (A) : master, (B) : 192.168.1.2;, (C) : 192.168.1.1, (D) : 192.168.1.2
2) Slave DNS 서버의 zone 파일 설정을 위하여, 다음 ( )에 들어갈 설정값을 쓰시오.
/etc/named.conf
zone "korea.go.kr" IN {
         type (E);
         file "slave/korea.go.kr.db";
         masters { (F) };
};
 - (E) : slave, (F) : 192.168.1.1;

[서술형]
13. BYOD 환경에서 모바일 오피스 서비스를 하려고 한다. 관련된 다음의 3가지 보안 기술에 대하여 설명하시오.
1) MDM(Mobile Device Management)
2) 컨테이너화
3) 모바일 가상화 
(답) 
1) MDM : 모바일 기기를 도난, 분실, 악용 등으로부터 보호하기 위하여 강화된 보안 정책(인증, 앱 화이트 리스트, 원격 삭제, 탈옥 탐지, 스크린 캡처 방지, 카메라 제어 등)을 적용하여 관리하기 위한 기술 
2) 컨테이너화 : 하나의 모바일 기기 내에 업무용과 개인용 영역을 컨테이너라는 별도의 공간으로 분리하여 프라이버시를 보호하기 위한 기술
3) 모바일 가상화 : 가상화 기술을 이용하여 하나의 모바일 기기에서 개인용 OS 영역과 업무용 OS 영역을 완전히 분리하는 기술. 평상시에는 개인용 OS 영역에서 모바일 기기를 이용하다가, 필요시 업무용 OS로 전환하여 사용. 
* BYOD 관련 보안 기술은 수험서에 있는 내용으로, 최소 10점 이상 획득 필요합니다. 

14. 다음의 위험 분석 방법에 대하여 개념과 장단점을 설명하시오. 
1) 기준선 접근법
2) 상세 위험 분석법
(답) 
1) 기준선 접근법
- 개념 : 모든 시스템에 대하여 보호의 기본 수준을 정하고 이를 달성하기 위한 일련의 보호대책을 표준화된 체크리스트를 기반으로 선택하는 방식
- 장점 : 체크리스트의 각 항목별 준수 여부를 점검하는 방식으로 간단하게 위험분석을 수행할 수 있어, 위험 분석 시간을 절약할 수 있음. 소규모 조직에 적합함.
- 단점 : 조직의 현황이 반영되지 않은 일률적인 기준으로 통제를 적용하는 경우 과보호 또는 부족한 보호가 될 가능성이 상존함. 체크리스트를 지속적으로 갱신하지 않으면 새로운 취약점과 같은 보안 환경의 변화를 적절하게 반영하기 어려움. 따라서, 자산 변동이 적거나 보안 환경의 변화에 크게 영향을 받지 않는 자산에 한정하여 사용하는 것이 권장됨.
2) 상세 위험 분석법
- 개념 : 정형화되고 구조화된 프로세스를 기반으로 자산 분석, 위협 분석, 취약성 분석의 각 단계를 수행하여 모든 정보자산에 대한 위험을 상세하게 분석하는 방식
- 장점 : 자산가치, 위협, 취약점의 평가에 기반하여 위험을 산정하므로 허용가능 수준까지 위험을 줄이는 근거를 명확히 할 수 있음. 계량적 수치화가 가능하며 평가의 완전성이 높음. 보안 환경의 변화에 따른 새로운 위험에 대한 분석도 용이에게 할 수 있음. 
- 단점 : 위험 분석 방법론을 잘 이해하고 있는 인적 자원이 필요하며, 위험분석에 시간, 노력, 비용이 많이 소요됨.
* 위험 분석 접근법은 자주 출제되는 킬러 토픽입니다. 10점 이상 획득해야 합니다. 

15. 다음의 쿠키 설정값의 의미를 보안 측면에서 설명하시오. 
1) Secure
2) HttpOnly
3) Expires
(답) 
1) Secure 통신(SSL/TLS)을 수해하는 경우에만 클라이언트에서 해당 쿠키를 전송함으로써 기밀성을 보장함. 스니핑 공격을 통한 쿠키 정보 탈취에 대응 가능.
2) 웹브라우저에서 자바스크립트(document.cookie) 등을 통한 해당 쿠키 접근을 차단함. 쿠키 탈취를 위한 XSS(Cross Site Scripting) 공격에 대응 가능.
3) 쿠키가 만료되는 날짜 및 시간을 설정함. 쿠키가 탈취당하여 재사용되는 리스크를 최소화할 수 있음.
* 쿠키 보안은 킬러 토픽이며, 16회 실기시험에서도 출제된 바 있습니다. 10점 이상 획득이 필요합니다.

16. DNS 증폭 공격에 사용되는 IP 공격 기법을 설명하고, 해당 공격 기법을 사용하는 이유를 설명하시오. 
(답) 
1) IP 공격 기법 : 출발지 IP를 공격 대상 서버의 IP로 위조하는 IP스푸핑을 수행 후, DNS 쿼리 타입을 ANY로 지정하여 request를 대량으로 수행하면, 다양한 TYPE의 레코드들이 Response 되므로 응답이 증폭되어 공격 대상 서버에 부하를 주게 됨
2) 해당 공격 기법 사용 이유
- 출발지 IP가 위조되고, 반사 서버를 통해 공격이 수행되므로 공격의 출처를 파악하기 어렵기 때문임. 특히 UDP는 별도의 인증 절차가 없으므로 공격 수행이 용이함.
- 다수의 좀비 PC를 동원하지 않더라도 대량의 공격 패킷을 공격 대상 서버로 향하도록 만들어 낼 수 있어 효율이 높기 때문임.
* DNS 증폭 공격은 18회 실기 시험에서도 동일하게 출제된 바 있습니다. 기출문제를 충실히 학습하신 분들은 10점 이상 획득 가능한 문제입니다. 

[실무형]
17. 다음의 HTTP Request 로그를 보고 물음에 답하시오.
[HTTP request]
GET /member/login.php?user_id=1' or '1' = '1'# &user_pw=foo HTTP/1.1
GET /member/login.php?user_id=1' or '1' = '1 &user_pw=foo HTTP/1.1
1) 해당 취약점은 무엇인가?
2) 그렇게 판단한 이유는?
3) 대응 방안은?
(답) 
1) SQL Injection
2) user_id에 특수 문자를 포함한 1' or '1'='1'#을 넣어서 로그인 검증을 하기 위한 SQL 문을 참으로 만들어 인증 로직을 우회하려는 시도를 하고 있기 때문임. 
3-1) 입력값에 특수 문자가 포함되지 않도록 필터링 로직을 구현(이 경우 클라이언트 단이 아닌 서버에 검증 로직을 반드시 넣어야 함. 자바스크립트로 클라이언트 단에서만 검증하는 경우 Paros, Burpsuite와 같은 proxy툴로 검증 로직을 우회할 수 있기 때문임) 
3-2) 서버의 DB Connection 구문을 Prepared Statement 방식으로 변경(사용자가 입력한 값이 SQL 명령의 일부가 아닌 매개 변수로 처리되기 때문에 해당 컬럼에만 들어가고 SQL문 전체에 영향을 주지 않음)

* SQL Injection은 핵심 토픽이며 실기시험에서 많이 출제된 바 있습니다. Blind SQL Injection을 포함하여 공격 원리 및 대응 방법을 철저하게 학습해야 합니다. 14점 이상 획득해야 하는 문제입니다. 
18. 개인 정보의 기술적, 관리적 보호 조치 기준에서 요구하고 있는 보호 조치 5가지를 기술하시오. 
(답) 
1) 접근통제
•	권한 부여, 변경 말소에 대한 내역을 기록하고 최소 5년 보관
•	외부에서 개인정보처리시스템 접속 시 안전한 인증 수단 적용
•	개인정보취급자를 대상으로 비밀번호 작성 규칙 수립 및 적용
•	개인정보취급자 컴퓨터에 대한 물리적 또는 논리적 망 분리 
2) 접속기록의 위/변조 방지
•	개인정보취급자가 개인정보처리시스템에 접속한 기록 월 1회 점검, 6개월 이상 접속기록 보존
•	접속 기록 위변조 방지를 위해 정기적인 백업 수행
3) 개인정보의 암호화 
•	비밀번호에 대한 일방향 암호화 저장
•	안전한 암호화 알고리즘으로 암호화 저장(주민등록번호 외 고유식별번호, 신용카드번호, 계좌번호, 바이오정보)
4) 악성프로그램 방지
•	백신 소프트웨어 등의 보안 프로그램 설치 및 운영
•	보안 프로그램 자동 업데이트 기능 사용 또는 일 1회 이상 업데이트
5) 물리적 접근 방지
•	개인정보를 보관하고 있는 물리적 장소에 대한 출입통제 절차 수립,운영
•	개인정보가 포함된 서류, 보조저장매체 등을 잠금장치가 있는 안전한 장소에 보관
